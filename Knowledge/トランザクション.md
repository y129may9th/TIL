## トランザクション

[11.6. トランザクションの定義](https://www.techscore.com/tech/sql/SQL11/11_03.html/)

- 分割不可な一連の処理
- 排他制御が必要
- ReadOnly（読み取り専用）
  - トランザクションが読み取り専用モードになる
  - SELECT文実行するとトランザクション開始前の状態のデータを参照
  - 読み取りモードのトランザクション実行中にデータが変更されても、その前の状態を参照しつづける
- ReadWrite（読み取り/書き込み可能）
  - 読み書きモード
  - INSERT, UPDATE, DELETE　でデータを変更できる
  - SELECTすると他のトランザクションによるデータの変更を参照できる
- 

### ロングトランザクション

- データベースとのトランザクションとは限らない
- データの取得と更新を別々のデータベースとして行う際に発生するトランザクション
  - 取得したでデータを編集画面に表示
  - 画面で編集した値をデータベースに更新する



### Spring のトランザクション管理

[Springでのトランザクション管理](https://qiita.com/NagaokaKenichi/items/a279857cc2d22a35d0dd)

1. プログラミングによるトランザクション管理

2. 宣言的トランザクション管理

   `@Transactional`アノテーションを付与

   - トランザクションの開始

   - コミット

   - ロールバック

     が自動で行われる

     - 非検査例外（RutimeExceptionおよびそのサブクラス）の発生でロールバック
     - 検査例外（Exception及びをのサブクラスでRuntimeExceptionのサブクラスでないもの）の発生はロールバックされずにコミットされる

- 非検査じゃなく検査例外でもロールバックしたい場合

  `@Transactional(rollbackFor = Exception.class)`

### 

## 排他制御

複数のトランザクションから同じデータに対して、同時に更新処理が行われる際にデータの整合性を保つために行う処理のこと

